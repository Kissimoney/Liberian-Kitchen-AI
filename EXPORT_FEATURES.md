# Recipe Export & Sharing Features

## Overview
Implemented comprehensive export and sharing capabilities for recipes, allowing users to download recipes as PDF or share them via WhatsApp.

## Features

### üì• PDF Export
Download recipes as professionally formatted PDF files for offline use, printing, or archiving.

#### Implementation
- **Library**: `html2pdf.js` for high-quality PDF generation
- **Format**: A4 page size, portrait orientation
- **Quality**: High-resolution (2x scale) with optimized compression
- **Filename**: Auto-generated from recipe title (sanitized)

#### PDF Features
- ‚úÖ Professional layout with proper margins (15mm all around)
- ‚úÖ High-quality image rendering (JPEG, 98% quality)
- ‚úÖ Page break optimization (sections stay together)
- ‚úÖ Print-friendly styles (black text, clean formatting)
- ‚úÖ Automatic compression for smaller file sizes
- ‚úÖ Preserves recipe structure and formatting

#### Technical Details
```javascript
{
  margin: [15, 15, 15, 15],
  format: 'a4',
  orientation: 'portrait',
  scale: 2, // High resolution
  quality: 0.98,
  compression: true,
  pagebreak: {
    avoid: ['.ingredients-section', '.instructions-section']
  }
}
```

### üí¨ WhatsApp Sharing
Share recipes directly via WhatsApp with beautifully formatted text.

#### Message Format
```
üç≥ *Recipe Title*

Description here...

‚è±Ô∏è *Prep:* 15 mins | *Cook:* 30 mins
üë• *Servings:* 4 | üå°Ô∏è *Temp:* 350¬∞F

üìã *INGREDIENTS*
1. Ingredient 1
2. Ingredient 2
...

üë®‚Äçüç≥ *INSTRUCTIONS*
*Step 1:* First instruction...

*Step 2:* Second instruction...

üè∑Ô∏è Tag1, Tag2, Tag3

_Generated by Liberian Kitchen AI_ üá±üá∑
```

#### Features
- ‚úÖ Emoji indicators for visual appeal
- ‚úÖ Bold text for headers and labels
- ‚úÖ Numbered lists for ingredients and steps
- ‚úÖ All recipe details included
- ‚úÖ Mobile and desktop support
- ‚úÖ Automatic URL encoding
- ‚úÖ Opens native WhatsApp app or web

#### Platform Detection
- **Mobile**: Opens WhatsApp mobile app (`whatsapp://send`)
- **Desktop**: Opens WhatsApp Web (`https://web.whatsapp.com/send`)

## User Interface

### Action Buttons
Added three prominent buttons to the recipe actions bar:

1. **Download PDF** (Amber)
   - Icon: Download ‚¨áÔ∏è
   - Color: Amber (#D97706)
   - Generates and saves PDF file

2. **WhatsApp** (Green)
   - Icon: MessageCircle üí¨
   - Color: Green (#16A34A)
   - Opens WhatsApp with formatted recipe

3. **Print** (Gray)
   - Icon: Printer üñ®Ô∏è
   - Color: Stone gray
   - Opens browser print dialog

### Responsive Design
- **Desktop**: Shows full button text
- **Mobile**: Shows icons only (text hidden via `sm:inline`)
- **Wrapping**: Buttons wrap on smaller screens

## Hook: useRecipeExport

### Functions

#### `downloadAsPDF(recipe, elementId)`
Generates and downloads a PDF file of the recipe.

**Parameters:**
- `recipe`: Recipe object
- `elementId`: DOM element to capture (default: 'recipe-content')

**Returns:** `Promise<boolean>`

**Error Handling:** Try-catch with user-friendly alert

#### `shareViaWhatsApp(recipe)`
Formats and shares recipe via WhatsApp.

**Parameters:**
- `recipe`: Recipe object

**Returns:** `boolean`

**Features:**
- Platform detection (mobile vs desktop)
- Automatic URL encoding
- Opens in new window

#### `copyRecipeText(recipe)`
Formats recipe as plain text.

**Parameters:**
- `recipe`: Recipe object

**Returns:** `string` (formatted recipe text)

**Use Cases:**
- Copy to clipboard
- Email sharing
- Text file export

#### `shareRecipe(recipe)`
Uses native Share API if available, with clipboard fallback.

**Parameters:**
- `recipe`: Recipe object

**Returns:** `Promise<boolean | 'copied'>`

**Fallback Chain:**
1. Native Share API (if supported)
2. Clipboard API
3. Error handling

## Installation

### Dependencies
```bash
npm install html2pdf.js
```

### Files Created
- `src/hooks/useRecipeExport.ts` - Main export hook
- Updated: `src/pages/RecipeDetails.tsx` - UI integration

## Usage

### In Components
```tsx
import { useRecipeExport } from '../hooks/useRecipeExport';

function RecipeComponent({ recipe }) {
  const { downloadAsPDF, shareViaWhatsApp } = useRecipeExport();

  // Download PDF
  const handleDownload = async () => {
    try {
      await downloadAsPDF(recipe, 'recipe-content');
    } catch (error) {
      alert('Failed to generate PDF');
    }
  };

  // Share on WhatsApp
  const handleWhatsApp = () => {
    shareViaWhatsApp(recipe);
  };

  return (
    <div id="recipe-content">
      {/* Recipe content */}
      <button onClick={handleDownload}>Download PDF</button>
      <button onClick={handleWhatsApp}>Share WhatsApp</button>
    </div>
  );
}
```

## Browser Compatibility

### PDF Export
- ‚úÖ Chrome/Edge (Chromium)
- ‚úÖ Firefox
- ‚úÖ Safari
- ‚úÖ Opera
- ‚ö†Ô∏è IE11 (not supported)

### WhatsApp Sharing
- ‚úÖ All modern browsers
- ‚úÖ Mobile devices (iOS, Android)
- ‚úÖ Desktop (via WhatsApp Web)

## Performance

### PDF Generation
- **Time**: 2-5 seconds (depending on recipe length)
- **File Size**: 100-500 KB (typical recipe)
- **Memory**: Minimal impact, cleanup after generation

### WhatsApp Sharing
- **Time**: Instant
- **Overhead**: Minimal (URL encoding only)

## Security & Privacy

### PDF Export
- ‚úÖ Client-side only (no server upload)
- ‚úÖ No external API calls
- ‚úÖ Data stays on user's device

### WhatsApp Sharing
- ‚úÖ Uses official WhatsApp URL scheme
- ‚úÖ No intermediary services
- ‚úÖ User controls sharing

## Best Practices

### PDF Export
1. **Element Selection**: Ensure `recipe-content` ID exists
2. **Styles**: Use print-friendly styles (already implemented)
3. **Images**: Optimize image sizes beforehand
4. **Error Handling**: Always wrap in try-catch

### WhatsApp Sharing
1. **Message Length**: Keep under 65536 characters (WhatsApp limit)
2. **Special Characters**: Properly encode (handled automatically)
3. **Links**: Can include recipe URL if needed

## Future Enhancements

### PDF Export
- [ ] **Custom templates**: Let users choose PDF styles
- [ ] **Multi-recipe export**: Combine multiple recipes in one PDF
- [ ] **Cover pages**: Add branded cover page
- [ ] **Table of contents**: For multi-page PDFs
- [ ] **QR codes**: Link back to online version

### WhatsApp Sharing
- [ ] **Images**: Include recipe image (requires different API)
- [ ] **Shortened links**: Use URL shortener for cleaner messages
- [ ] **Templates**: Multiple message formats to choose from
- [ ] **Contact selection**: Suggest relevant contacts

### Additional Export Formats
- [ ] **JSON export**: For backup and transfer
- [ ] **Markdown**: For developers and note-takers
- [ ] **Email**: Direct email send with formatted recipe
- [ ] **Recipe XML/Schema**: For recipe management apps
- [ ] **Shopping list**: Extract just ingredients as checklist

### Social Sharing
- [ ] **Facebook**: Share with image
- [ ] **Twitter**: Share with hashtags
- [ ] **Instagram Stories**: Export as story-friendly image
- [ ] **Pinterest**: Pin with automatic formatting

## Troubleshooting

### PDF Not Generating
**Issue**: PDF download doesn't start
**Solutions**:
- Check if element ID 'recipe-content' exists
- Verify html2pdf.js is installed
- Check console for errors
- Try refreshing the page

### WhatsApp Not Opening
**Issue**: WhatsApp doesn't launch
**Solutions**:
- Ensure WhatsApp is installed (mobile)
- Check browser pop-up blocker settings
- Verify URL encoding is correct
- Try on different browser

### PDF Missing Content
**Issue**: PDF is blank or incomplete
**Solutions**:
- Wait for images to load before generating
- Check for styling conflicts
- Verify element is visible when capturing
- Use print preview to debug

## Testing Checklist

- [x] PDF generates successfully
- [x] PDF includes all content
- [x] PDF formatting is clean
- [x] File downloads with correct name
- [x] WhatsApp opens correctly
- [x] Message format is readable
- [x] Mobile WhatsApp app launches
- [x] Desktop WhatsApp Web opens
- [x] All recipe details included
- [x] Buttons visible and clickable
- [x] Error handling works
- [x] Mobile responsive design

## Analytics Considerations

Track the usage of export features:
- PDF download count
- WhatsApp share count
- Export success/failure rates
- Most shared recipes
- User preferences (PDF vs WhatsApp)

This data can help improve the features and understand user behavior.
